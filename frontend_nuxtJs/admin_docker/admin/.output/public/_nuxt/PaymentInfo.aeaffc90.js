import{_ as l,o as n,c as _,F as g,i as $,a as o,t as c,d as w,q as x,j as h,p as k,f as S,k as I,v as O,g as u,r as b,s as f}from"./entry.73d06ff6.js";import{a as y,b as v}from"./main.31482b52.js";const C={el:"#orderProductList",setup(){},props:["orderList"]},D={id:"orderProductList"},L={class:"w-sto flex jus-sp"},F={class:"flex"},B={class:"img_order_product_div"},N=["src"],P={class:"info_order_product_div"},V={class:"name_order_product"};function T(e,t,s,i,a,d){return n(),_("div",D,[(n(!0),_(g,null,$(s.orderList,(r,p)=>(n(),_("div",{key:r.id,class:"product_order_info"},[o("div",L,[o("p",null,c(p+1),1),w(),o("p",null,c(r.price*r.count)+" "+c(r.price_currency),1)]),o("div",F,[o("div",B,[o("img",{class:"img_order_product",src:e.$api_root+r.productItem.product.image,alt:""},null,8,N)]),o("div",P,[o("div",V,c(r.productItem.product.name)+" "+c(r.productItem.weight?"["+r.productItem.weight.weight+"гр]":""),1),o("p",null,c(r.productItem.price)+" "+c(r.productItem.price_currency),1),o("p",null,c(r.count)+" шт",1)])]),x(e.$slots,"default",{orderItem:r},void 0,!0)]))),128))])}const se=l(C,[["render",T],["__scopeId","data-v-a59f5cb1"]]);async function j(e,t){console.log(t);try{var s=await y({url:`${v}api/v0.1/delivery/${e}/track_number`,method:"post",headers:{},data:t});return s}catch(i){return i.response}}const E={props:["delivery"],methods:{async submit(){let e=new FormData(document.getElementById("DeliveryInfoSubmitFrom")),t=await j(this.delivery.id,e);console.log(this.delivery),this.$emit("delivery_info_submit",t.data)}}},M=e=>(k("data-v-c0ccb281"),e=e(),S(),e),q={id:"DeliveryInfoSubmitFrom",action:"",method:"get"},A=M(()=>o("input",{type:"text",name:"track_number",value:"",placeholder:"Трек номер"},null,-1));function U(e,t,s,i,a,d){return n(),_("form",q,[A,o("button",{onClick:t[0]||(t[0]=h(r=>d.submit(),["prevent"])),style:{"margin-top":"2%"},class:"btn"},"Добавить данные доставки")])}const z=l(E,[["render",U],["__scopeId","data-v-c0ccb281"]]);async function G(e,t){try{var s=await y({url:`${v}api/v0.1/orders/${e}/closed`,method:"post",headers:{},data:{description:t}});return s}catch(i){return i.response}}const H={props:["order"],data(){return{closed_order_s:!1,cause:""}},methods:{async submit(){},async closed_order(){if(this.closed_order_s){let e=await G(this.order.id,this.cause);this.$emit("order_status_closed",e.data)}else this.closed_order_s=!0}}},J={id:"DeliveryInfoSubmitFrom",action:"",method:"get"};function K(e,t,s,i,a,d){return n(),_("form",J,[a.closed_order_s?I((n(),_("input",{key:0,type:"text",name:"track_number","onUpdate:modelValue":t[0]||(t[0]=r=>a.cause=r),placeholder:"Причина отказа"},null,512)),[[O,a.cause]]):u("",!0),o("button",{onClick:t[1]||(t[1]=h(r=>d.closed_order(),["prevent"])),style:{"margin-top":"2%"}},"Отменить заказ")])}const Q=l(H,[["render",K],["__scopeId","data-v-31a9d5b2"]]);const R={components:{DeliveryInfoSubmit:z,OrderStatusClosed:Q},props:["order","delivery"],methods:{async submit_waiting(){this.$emit("submit_waiting")},delivery_info_submit(e){this.$emit("delivery_info_submit",e)},async submit_order(){this.$emit("submit_order")},order_status_closed(e){try{console.log(e),this.order=e,this.delivery.status="Отменен"}catch{this.$emit("order_status_closed",e)}}}},W={key:4,class:"btn"};function X(e,t,s,i,a,d){const r=b("delivery-info-submit"),p=b("order-status-closed");return n(),_("div",null,[s.delivery.status=="На проверке"&&s.order.status=="Одобрен"?(n(),_("button",{key:0,class:"btn",onClick:t[0]||(t[0]=m=>d.submit_waiting())}," Подтвердить доставку ")):u("",!0),s.order.status=="Не одобренный"&&s.order.payment.status=="succeeded"?(n(),_("button",{key:1,class:"btn",onClick:t[1]||(t[1]=m=>d.submit_order())}," Подтвердить заказ ")):s.delivery.status=="Ожидание доставки"?(n(),f(r,{key:2,onDelivery_info_submit:t[2]||(t[2]=m=>d.delivery_info_submit(m)),delivery:s.delivery,style:{"margin-top":"2%"}},null,8,["delivery"])):u("",!0),s.delivery.status=="На проверке"&&s.order.status!="Одобрен"&&s.order.payment.status!="succeeded"?(n(),f(p,{key:3,style:{"margin-top":"3%"},onOrder_status_closed:d.order_status_closed,order:s.order},null,8,["onOrder_status_closed","order"])):u("",!0),s.delivery.status=="Отправлен"?(n(),_("button",W," Отследить заказ ")):u("",!0)])}const re=l(R,[["render",X],["__scopeId","data-v-4b290a6c"]]);async function oe(e){try{var t=await y({url:`${v}api/v0.1/orders/${e}/approved`,method:"post",headers:{}});return t}catch(s){return s.response}}const Y={props:["payment"]};function Z(e,t,s,i,a,d){return n(),_("div",null,[o("p",null,"Статус оплаты: "+c(s.payment.status),1)])}const ne=l(Y,[["render",Z],["__scopeId","data-v-93479e9a"]]);export{se as O,ne as P,re as a,oe as s};
