import{_ as l,o as n,c as d,F as g,l as $,a as o,t as a,d as w,x,g as p,h as y,q as h,p as k,f as S,k as I,v as D,i as u,r as f,y as b}from"./entry.66c47c99.js";const O={el:"#orderProductList",setup(){},props:["orderList"]},C={id:"orderProductList"},L={class:"w-sto flex jus-sp"},F={class:"flex"},B={class:"img_order_product_div"},N=["src"],P={class:"info_order_product_div"},V={class:"name_order_product"};function T(e,t,s,_,c,i){return n(),d("div",C,[(n(!0),d(g,null,$(s.orderList,(r,v)=>(n(),d("div",{key:r.id,class:"product_order_info"},[o("div",L,[o("p",null,a(v+1),1),w(),o("p",null,a(r.price*r.count)+" "+a(r.price_currency),1)]),o("div",F,[o("div",B,[o("img",{class:"img_order_product",src:e.$api_root+r.productItem.product.image,alt:""},null,8,N)]),o("div",P,[o("div",V,a(r.productItem.product.name)+" "+a(r.productItem.weight?"["+r.productItem.weight.weight+"гр]":""),1),o("p",null,a(r.productItem.price)+" "+a(r.productItem.price_currency),1),o("p",null,a(r.count)+" шт",1)])]),x(e.$slots,"default",{orderItem:r},void 0,!0)]))),128))])}const te=l(O,[["render",T],["__scopeId","data-v-a59f5cb1"]]);async function E(e,t){console.log(t);try{var s=await p({url:`${y}api/v0.1/delivery/${e}/track_number`,method:"post",headers:{},data:t});return s}catch(_){return _.response}}const M={props:["delivery"],methods:{async submit(){let e=new FormData(document.getElementById("DeliveryInfoSubmitFrom")),t=await E(this.delivery.id,e);console.log(this.delivery),this.$emit("delivery_info_submit",t.data)}}},j=e=>(k("data-v-c0ccb281"),e=e(),S(),e),q={id:"DeliveryInfoSubmitFrom",action:"",method:"get"},A=j(()=>o("input",{type:"text",name:"track_number",value:"",placeholder:"Трек номер"},null,-1));function U(e,t,s,_,c,i){return n(),d("form",q,[A,o("button",{onClick:t[0]||(t[0]=h(r=>i.submit(),["prevent"])),style:{"margin-top":"2%"},class:"btn"},"Добавить данные доставки")])}const z=l(M,[["render",U],["__scopeId","data-v-c0ccb281"]]);async function G(e,t){try{var s=await p({url:`${y}api/v0.1/orders/${e}/closed`,method:"post",headers:{},data:{description:t}});return s}catch(_){return _.response}}const H={props:["order"],data(){return{closed_order_s:!1,cause:""}},methods:{async submit(){},async closed_order(){if(this.closed_order_s){let e=await G(this.order.id,this.cause);this.$emit("order_status_closed",e.data)}else this.closed_order_s=!0}}},J={id:"DeliveryInfoSubmitFrom",action:"",method:"get"};function K(e,t,s,_,c,i){return n(),d("form",J,[c.closed_order_s?I((n(),d("input",{key:0,type:"text",name:"track_number","onUpdate:modelValue":t[0]||(t[0]=r=>c.cause=r),placeholder:"Причина отказа"},null,512)),[[D,c.cause]]):u("",!0),o("button",{onClick:t[1]||(t[1]=h(r=>i.closed_order(),["prevent"])),style:{"margin-top":"2%"}},"Отменить заказ")])}const Q=l(H,[["render",K],["__scopeId","data-v-31a9d5b2"]]);const R={components:{DeliveryInfoSubmit:z,OrderStatusClosed:Q},props:["order","delivery"],methods:{async submit_waiting(){this.$emit("submit_waiting")},delivery_info_submit(e){this.$emit("delivery_info_submit",e)},async submit_order(){this.$emit("submit_order")},order_status_closed(e){try{console.log(e),this.order=e,this.delivery.status="Отменен"}catch{this.$emit("order_status_closed",e)}}}},W={key:4,class:"btn"};function X(e,t,s,_,c,i){const r=f("delivery-info-submit"),v=f("order-status-closed");return n(),d("div",null,[s.delivery.status=="На проверке"&&s.order.status=="Одобрен"?(n(),d("button",{key:0,class:"btn",onClick:t[0]||(t[0]=m=>i.submit_waiting())}," Подтвердить доставку ")):u("",!0),s.order.status=="Не одобренный"&&s.order.payment.status=="succeeded"?(n(),d("button",{key:1,class:"btn",onClick:t[1]||(t[1]=m=>i.submit_order())}," Подтвердить заказ ")):s.delivery.status=="Ожидание доставки"?(n(),b(r,{key:2,onDelivery_info_submit:t[2]||(t[2]=m=>i.delivery_info_submit(m)),delivery:s.delivery,style:{"margin-top":"2%"}},null,8,["delivery"])):u("",!0),s.delivery.status=="На проверке"&&s.order.status!="Одобрен"&&s.order.payment.status!="succeeded"?(n(),b(v,{key:3,style:{"margin-top":"3%"},onOrder_status_closed:i.order_status_closed,order:s.order},null,8,["onOrder_status_closed","order"])):u("",!0),s.delivery.status=="Отправлен"?(n(),d("button",W," Отследить заказ ")):u("",!0)])}const se=l(R,[["render",X],["__scopeId","data-v-4b290a6c"]]);async function re(e){try{var t=await p({url:`${y}api/v0.1/orders/${e}/approved`,method:"post",headers:{}});return t}catch(s){return s.response}}const Y={props:["payment"]};function Z(e,t,s,_,c,i){return n(),d("div",null,[o("p",null,"Статус оплаты: "+a(s.payment.status),1)])}const oe=l(Y,[["render",Z],["__scopeId","data-v-93479e9a"]]);async function ne(e){try{var t=await p({url:`${y}api/v0.1/delivery/${e}/get_info_in_order`,method:"post",headers:{},data:{delivery_engine:"sdek",order_engine:"online_store",pred_payment:"yes",tariff_code:216}});return t}catch(s){return s.response}}async function de(e,t){try{var s=await p({url:`${y}api/v0.1/delivery/initial/`,method:"post",headers:{},data:{delivery_info:t,delivery_id:e}});return s}catch(_){return _.response}}export{te as O,oe as P,se as a,ne as g,de as i,re as s};
