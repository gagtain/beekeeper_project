import{g as _,h,_ as f,c as i,a as e,i as p,k as d,v as c,o as r,p as g,f as v}from"./entry.66c47c99.js";async function u(o){try{var s=await _({url:`${h}api/token/`,method:"post",data:o,headers:{"Content-Type":"application/json"},withCredentials:!0});return s}catch(a){return a.response}}async function w(o){try{var s=await _({url:`${h}api/v0.1/user/set_token`,method:"post",data:o,headers:{"Content-Type":"application/json"},withCredentials:!0});return s}catch(a){return a.response}}const y={data(){return{username:null,password:null,error:!1,is_code:!1,code:""}},methods:{async validation(){var o;if(this.is_code)(await u({username:this.username,password:this.password,is_admin:!0,token:this.code})).status==200?this.$router.push("/admin"):this.error=!0;else{let s=await u({username:this.username,password:this.password,is_admin:!0});(s==null?void 0:s.status)==400&&((o=s==null?void 0:s.data)==null?void 0:o.error)=="Не указано поле token"?(await w({username:this.username,password:this.password}),this.is_code=!0):s.status==200?this.$router.push("/admin"):this.error=!0}}}},l=o=>(g("data-v-b17522c6"),o=o(),v(),o),k={class:"login"},b={class:"login-screen"},x={class:"app-title"},C=l(()=>e("h1",null,"Login",-1)),V={key:0,class:"form-error"},I={class:"login-form"},B={key:0,class:"control-group"},S=l(()=>e("label",{class:"login-field-icon fui-user",for:"login-name"},null,-1)),T={key:1,class:"control-group"},U=l(()=>e("label",{class:"login-field-icon fui-lock",for:"login-pass"},null,-1)),j={key:2,class:"control-group"},N=l(()=>e("label",{class:"login-field-icon fui-lock",for:"login-pass"},null,-1));function D(o,s,a,E,t,m){return r(),i("body",null,[e("div",k,[e("div",b,[e("div",x,[C,t.error?(r(),i("p",V,"Неверные данные")):p("",!0)]),e("div",I,[t.is_code?p("",!0):(r(),i("div",B,[d(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t.username=n),type:"text",class:"login-field",placeholder:"username",id:"login-name"},null,512),[[c,t.username]]),S])),t.is_code?(r(),i("div",j,[d(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>t.code=n),type:"text",class:"login-field",placeholder:"code",id:"login-pass"},null,512),[[c,t.code]]),N])):(r(),i("div",T,[d(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>t.password=n),type:"password",class:"login-field",placeholder:"password",id:"login-pass"},null,512),[[c,t.password]]),U])),e("a",{onClick:s[3]||(s[3]=n=>m.validation()),class:"btn btn-primary btn-large btn-block"},"login")])])])])}const M=f(y,[["render",D],["__scopeId","data-v-b17522c6"]]);export{M as default};
