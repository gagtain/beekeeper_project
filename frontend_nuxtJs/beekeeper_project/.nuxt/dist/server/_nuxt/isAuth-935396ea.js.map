{"version":3,"file":"isAuth-935396ea.js","sources":["../../../../middleware/isAuth.js"],"sourcesContent":["import verifAssessToken from \"../additional_func/verifAssessToken\"\n\nimport { useMainStore } from \"../store\";\nexport default async (event) => {\n  const stores = useMainStore()\n    if (useCookie('assess').value || useCookie('refresh').value){\n      console.log('Есть токен')\n      // проверка токена \n      stores.assess_token = useCookie('assess')\n      let assess_response = await verifAssessToken(stores.assess_token)\n      if (!(assess_response.status == 200)){\n      // если нет\n          if (useCookie('refresh')){\n              console.log('Есть рефреш')\n              return\n              // проверка рефреша \n              // если верен то вернуть страницу\n              // если не верен то перейти на логин\n          }else{\n              console.log('Нет рефреша')\n              if (event.req.url != '/login'){\n        \n                return sendRedirect(event, '/login', 302)\n              }else{\n                event.context.$assess_token = '123'\n              }\n  \n          }\n      }\n      \n      \n      \n      // if запрос верен, document.cookie = \"token=\" + token\n      // else проверка на refresh, если он верен то запись токена\n      // else return next('/login')\n  }else{\n      \n      console.log('Нет токена')\n      if (event.href != '/login'){\n\n        return navigateTo('/login')\n      }\n  }\n  }"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAGA,MAAe,SAAA,OAAO,UAAU;AAC9B,QAAM,SAAS,aAAc;AAC3B,MAAI,UAAU,QAAQ,EAAE,SAAS,UAAU,SAAS,EAAE,OAAM;AAC1D,YAAQ,IAAI,YAAY;AAExB,WAAO,eAAe,UAAU,QAAQ;AACxC,QAAI,kBAAkB,MAAM,iBAAiB,OAAO,YAAY;AAChE,QAAI,EAAE,gBAAgB,UAAU,MAAK;AAEjC,UAAI,UAAU,SAAS,GAAE;AACrB,gBAAQ,IAAI,aAAa;AACzB;AAAA,MAId,OAAe;AACD,gBAAQ,IAAI,aAAa;AACzB,YAAI,MAAM,IAAI,OAAO,UAAS;AAE5B,iBAAO,aAAa,OAAO,UAAU,GAAG;AAAA,QACxD,OAAmB;AACH,gBAAM,QAAQ,gBAAgB;AAAA,QAC/B;AAAA,MAEJ;AAAA,IACJ;AAAA,EAOP,OAAO;AAED,YAAQ,IAAI,YAAY;AACxB,QAAI,MAAM,QAAQ,UAAS;AAEzB,aAAO,WAAW,QAAQ;AAAA,IAC3B;AAAA,EACJ;AACH;"}