{"version":3,"file":"UserBasket-136b769c.js","sources":["../../../../components/UserComp/BasketComp/BasketInfo.vue","../../../../additional_func/updateCountBasketItem.js","../../../../components/UserComp/BasketComp/CountProduct.vue","../../../../components/UserComp/BasketList.vue","../../../../components/UserComp/UserBasket.vue"],"sourcesContent":["<template>\n  <div class=\"register_zakaz\">\n    <div class=\"kor_all_info auto w-sto\">\n      <p class=\"VAG small zakaz_info_of\">Информация о корзине</p>\n      <p class=\"m2\">Товаров: {{ getCountBasket() }}</p>\n      <p class=\"m2\">Вес: {{getWeight()}}</p>\n      <p class=\"m2\">\n        Цена:\n        {{\n          USER_STATE.basket.reduce(function (sum, elem) {\n            return sum + parseFloat(elem.productItem.product.price);\n          }, 0)\n        }}\n      </p>\n      <p class=\"m2\">скидки:</p>\n      <ul>\n        <li>*в разработке*</li>\n      </ul>\n      <p id=\"is\" class=\"small\">\n        Итоговая сумма:\n        {{\n          getSumm()\n        }}\n      </p>\n      <button v-if=\"USER_STATE.basket.length\" class=\"w-sto\"> <div class=\"fon_btn\"></div>Оформить</button>\n      <RouterLink v-else to=\"/catalog\"><button class=\"w-sto\"> <div class=\"fon_btn\"></div> Добавить товар</button></RouterLink>\n    </div>\n  </div>\n</template>\n\n<style lang=\"css\" src=\"../../../assets/css/account.css\" scoped></style>\n<style scoped>\n.fon_btn{\n  background: url(http://localhost:8080/img/sot.0b9dac38.png) center no-repeat;\nopacity: 0.1;\nposition: absolute;\nheight: 100%;\nwidth: 100%;\ntop: 0;\nleft: 0;\n}\n</style>\n<script>\nexport default {\n  el: \"#reg_zakaz\",\n  name: \"BasketInfo\",\n  data(){\n    return {\n      summ: 0,\n      USER_STATE: this.$store.getUser\n    }\n  },\n  created() {},\n  methods: {\n    getCountBasket() {\n      let count = 0;\n      this.USER_STATE.basket.forEach((element) => {\n        count += parseInt(element.count);\n      });\n      return count;\n    },\n    getWeight(){\n      let weight = this.USER_STATE.basket.reduce(function (weight_s, elem) {\n        return weight_s + parseFloat(elem.productItem.weight.weight * elem.count);\n      }, 0);\n      let str_weight = ``\n      if (weight >= 1000){\n        weight = weight / 1000\n      str_weight = `${weight} кг`\n      }else{\n\n        str_weight = `${weight} гр`\n      }\n      return str_weight\n    },\n    getSumm() {\n      let summ = this.USER_STATE.basket.reduce(function (sum, elem) {\n        return sum + parseFloat(elem.productItem.product.price * elem.count);\n      }, 0);\n      return summ\n    },\n  },\n};\n</script>\n","import axios from \"axios\";\nimport { api_root } from '@/main'\n\nexport default async function updateCountBasketItem(basketItem_pk, count){\n    try {\n        var response = await axios({url: `${api_root}api/v0.1/beekeeper_web_api/basket/${basketItem_pk}/update_count`,\n        method: \"post\",\n        headers:{\n            \"Authorization\": `Bearer ${useCookie('assess').value}`\n\n        },\n        data:{\n          count: count\n        }\n      })\n      return response\n      } catch (error) {\n        return error.response\n      }\n    }","<template>\n\n            <div class=\"input-number\" id=\"count_button\">\n    <div class=\"input-number__minus\" @click=\"minus_input($event)\">-</div>\n    <input class=\"input-number__input\" @keydown=\"input_keydown($event)\" type=\"text\" pattern=\"^[0-9]+$\" @focusout=\"input_onfocus($event)\" @input=\"re_count($event)\"  :value=\"USER_STATE.basket.filter(f => f.id == id)[0].count\">\n    <div class=\"input-number__plus\" @click=\"plus_input($event)\">+\n</div>\n\n          </div>\n</template>\n\n<style>\n.input-number {\n    display: flex;\n    align-items: center;\n    background: #FFFFFF;\n    border: 1px solid #E5E8EE;\n    box-sizing: border-box;\n    border-radius: 6px;\n    color: #424348;\n    font-size: 14px;\n    text-align: center;\n    width: 100%;\n}\n\n.input-number__input {\n    background: #E5E8EE;\n    width: 60%;\n    height: 32px;\n    border: none;\n    padding: 8px;\n    text-align: center;\n}\n\n.input-number__minus,\n.input-number__plus {\n  font-size: 20px;\n    width: 33%;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    user-select: none;\n}\n</style>\n\n<script>\n\nimport updateCountBasketItem from '@/additional_func/updateCountBasketItem'\n\nexport default{\n    el:'#count_button',\n    name:'CountProduct',\n    props: ['id'],\n    data(){\n        return {\n            time_prover: null,\n            USER_STATE: this.$store.getUser\n        }\n    },\n    methods:{\n\n        async re_basketItem(){\n            let response = await updateCountBasketItem(this.id, this.USER_STATE.basket.filter(f => f.id == this.id)[0].count)\n            if (response.status == 400){\n                this.$store.REMOVE_BASKET_ITEM(this.id)\n            }else{\n                this.USER_STATE.basket.filter(f => f.id == this.id)[0] == response.data\n            }\n        },\n\n\n        re_count(event){\n            if (!(event.srcElement.value == '' || event.srcElement.value == '0')){\n                \n                this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id: this.id, count: parseInt(event.srcElement.value)})\n                this.re_basketItem()\n            }\n        },\n        input_onfocus(event){\n            if(event.srcElement.value == ''){\n                event.srcElement.value = this.BASKET_LIST_STATE.filter(f => f.id == this.id)[0].count\n            }else if(event.srcElement.value == '0'){\n                if (this.BASKET_LIST_STATE.filter(f => f.id == this.id)[0].count != 1){\n                    this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id: this.id, count: 1})\n                    this.re_basketItem()\n                }else{\n                    event.srcElement.value = 1\n                }\n            }\n        },\n        minus_input (event) {\n        let total = event.srcElement.nextElementSibling;\n        let value = parseInt(total.value)\n        if (total.value > 1) {\n            this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id: this.id, count: value - 1})\n        setTimeout(() => { let count = value - 1\n            if (count == event.srcElement.nextElementSibling.value  ){\n                    this.re_basketItem()\n                console.log(1)\n            }else{\n                console.log(count, event.srcElement.nextElementSibling.value)\n            } }, 1000);\n        }\n        \n    },\n    // Увеличиваем на 1\n    plus_input (event) {\n        \n        let total = event.srcElement.previousElementSibling;\n        let value = parseInt(total.value)\n        this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id: this.id, count: value + 1})\n        setTimeout(() => { let count = value + 1\n            if (count == event.srcElement.previousElementSibling.value){\n                this.re_basketItem()\n                console.log(1)\n            } }, 1000);\n    },\n\n    // Запрещаем ввод текста \n    \n        input_keydown (event) {\n            // Разрешаем: backspace, delete, tab\n            if (event.keyCode == 46 || event.keyCode == 8 || event.keyCode == 9 ||\n                // Ctrl+A\n                (event.keyCode == 65 && event.ctrlKey === true) ||\n                // ← →\n                (event.keyCode >= 35 && event.keyCode <= 39)) {\n                return;\n            } else {\n                // Только цифры\n                if ((event.keyCode < 48 || event.keyCode > 57) && (event.keyCode < 96 || event.keyCode > 105)) {\n                    \n                    event.preventDefault();\n                }\n                \n            }\n\n        },\n    },\n}\n\n</script>","<template>\r\n    <div class=\"list_tovar_kor w-sto\">\r\n    <div v-for=\"b in USER_STATE.basket\" :key=\"b.id\"  class=\"tovar w-sto flex\">\r\n    <div class=\"tovar_kor_img_div\">\r\n      <img\r\n        class=\"tovar_kor_img\"\r\n        :src=\"$api_root + b.productItem.product.image\"\r\n        alt=\"\"\r\n      />\r\n    </div>\r\n    <div class=\"info_tovar_kor flex jus-sp\">\r\n      <div class=\"info_tovar_kor_osnov\">\r\n        <p class=\"normal-small tovar_kor_name\">{{ b.productItem.product.name }} [{{ b.productItem.weight.weight }} гр, {{ b.productItem.type_packaging.name }}]</p>\r\n\r\n        <p class=\"normal-small info_in_tovar_kor description\">\r\n          {{ b.productItem.product.price }} {{ b.productItem.product.price_currency }}\r\n        </p>\r\n        <div class=\"btn_tovar_kor flex\">\r\n          <FavoriteComp :ProductItem=\"b.productItem\" ></FavoriteComp>\r\n          <AddBasket :ProductItem=\"b.productItem\" ></AddBasket>\r\n        </div>\r\n      </div>\r\n      <div class=\"size_tovar_div\">\r\n        <div class=\"size_tovar_kor\">\r\n          <div class=\"select_size\">\r\n            <button style=\"background: rgb(76, 175, 80); cursor: pointer;width: 100%;height: 32px;border: none;border-radius: 6px;\" onclick=\"alert('в разработке')\">Изменить</button>\r\n            \r\n<p class=\"normal-small kolvo\">количество</p>\r\n<CountProduct :id=\"b.id\"></CountProduct>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  </div>\r\n  \r\n  <div v-if=\"!USER_STATE.basket.length\"  style=\"width: 50%;margin: auto;margin-top: 10%;\">\r\n                    \r\n                    <p style=\"font-size: 28px;\" class=\"VAG\">Список корзины пуст :(</p>\r\n                    <div class=\"select_size\" >\r\n                      <router-link to=\"/catalog\">\r\n                            <button style=\"background: rgb(76, 175, 80); cursor: pointer; width: 100%; border: medium none; border-radius: 6px;font-size: 26px;padding: 2%;margin-top: 1%;\" >\r\n                              Перейти в каталог\r\n                            </button>\r\n                          </router-link>\r\n                          </div>\r\n                  </div>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"css\" src=\"../../assets/css/account.css\" scoped></style>\r\n\r\n<style>\r\n.tovar_kor_img_div img{\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n.description{\r\n    max-width: 90%;\r\n    font-size: 30px;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport AddBasket from './BasketComp/AddBasket.vue'\r\nimport CountProduct from './BasketComp/CountProduct.vue'\r\nimport FavoriteComp from './BasketComp/FavoriteComp.vue'\r\nexport default {\r\n    data(){\r\n      return{\r\n\r\n        USER_STATE: this.$store.getUser\r\n      }\r\n    },\r\n    components:{\r\n      AddBasket,\r\n      FavoriteComp,\r\n      CountProduct\r\n    },\r\n    created(){\r\n    },\r\n  methods:{\r\n   \r\n  }\r\n}\r\n</script>","<template>\r\n  <div class=\"w-sto kor\" id=\"kor\">\r\n    <p class=\"small-big VAG\">Корзина</p>\r\n    <div class=\"w-sto flex kor_block\">\r\n        <BasketList></BasketList>\r\n\r\n\r\n      \r\n        <BasketInfo></BasketInfo>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"css\" src=\"../../assets/css/account.css\" scoped></style>\r\n<script>\r\nimport BasketInfo from './BasketComp/BasketInfo.vue'\r\nimport BasketList from './BasketList.vue';\r\nexport default {\r\n    el: '#kor',\r\n    name: 'UserBasket',\r\n    components:{\r\n        BasketList,\r\n        BasketInfo\r\n    }\r\n};\r\n</script>\r\n"],"names":["_sfc_main","_ssrRenderAttrs","_mergeProps","_ssrInterpolate","_ssrRenderComponent","_push","_parent","_createVNode","_ssrRenderAttr"],"mappings":"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"}