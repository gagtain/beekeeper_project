import{B as U,P as L}from"./BasketInfo.438c3f4d.js";import{a as m,y as z,o as _,b as c,e,F as f,k as h,t as a,z as k,A as b,h as F,i as G,j as P,r as l,c as g,v as y,B as $,p as S,l as V,f as v}from"./entry.e4d18448.js";import{c as x,r as w,u as T}from"./index.5f451472.js";const j={el:"#check_form",data(){return{USER_STATE:this.$store.getUser}},methods:{order_info_select(){return this.v$.$touch(),console.log(this.v$.$errors),this.v$.$errors.length?{status:!0}:{status:!0,adress:this.state.adress.value,index:this.state.index.value}}},setup(){const s=z({adress:{value:""},index:{value:""}}),o={adress:{value:{required:x.withMessage("Требуется",w)}},index:{value:{required:x.withMessage("Требуется",w)}}},i=T(o,s);return{state:s,v$:i}}},q={id:"check_form"},E={class:"h_sto"},M={class:"error_list"},N={class:"error_list"};function R(s,o,i,d,u,n){return _(),c("div",q,[e("div",E,[e("div",M,[(_(!0),c(f,null,h(d.v$.adress.value.$errors,t=>(_(),c("div",{key:t.$uid},a(t.$message),1))),128))]),k(e("input",{type:"text",placeholder:"Адрес","onUpdate:modelValue":o[0]||(o[0]=t=>d.v$.adress.value.$model=t)},null,512),[[b,d.v$.adress.value.$model]]),e("div",N,[(_(!0),c(f,null,h(d.v$.index.value.$errors,t=>(_(),c("div",{key:t.$uid},a(t.$message),1))),128))]),k(e("input",{type:"text",placeholder:"Индекс","onUpdate:modelValue":o[1]||(o[1]=t=>d.v$.index.value.$model=t)},null,512),[[b,d.v$.index.value.$model]])])])}const D=m(j,[["render",R],["__scopeId","data-v-798b89f9"]]);async function O(s,o){try{var i=await F({url:`${G}api/v0.1/beekeeper_web_api/order/create`,method:"post",headers:{Authorization:`Bearer ${P("assess").value}`},data:{address:s,index:o}});return i}catch(d){return d.response}}const H={el:"#sub_order",props:["items","forms_validate"],methods:{async submin_order(){await this.$emit("forms_validate_met"),this.forms_validate.status&&(await O(this.forms_validate.adress,this.forms_validate.index)).status==200&&this.$router.push("/orders")}}},I=s=>(S("data-v-f5b3d10f"),s=s(),V(),s),J={id:"sub_order",class:"w-sto"},K=I(()=>e("div",{class:"fon_btn"},null,-1)),Q=I(()=>e("button",{class:"w-sto"},[e("div",{class:"fon_btn"}),$(" Добавить товар")],-1));function W(s,o,i,d,u,n){const t=l("RouterLink");return _(),c("div",J,[i.items.length?(_(),g(t,{key:0,to:"/checkout"},{default:y(()=>[e("button",{onClick:o[0]||(o[0]=(...p)=>n.submin_order&&n.submin_order(...p)),class:"w-sto"},[K,$("Оплатить онлайн")])]),_:1})):(_(),g(t,{key:1,to:"/catalog"},{default:y(()=>[Q]),_:1}))])}const X=m(H,[["render",W],["__scopeId","data-v-f5b3d10f"]]);const Y={el:"#checkout",components:{BasketInfo:U,Checkout:D,ProductListInfo:L,Submit_order:X},data(){return{forms_validate:!1}},methods:{async submin_order(){(await addOrder()).status==200&&this.$router.push("/orders")},forms_validate_met(){this.forms_validate=this.$refs.checkout_form.order_info_select(),console.log(this.forms_validate)}}},B=s=>(S("data-v-bf2e6f6c"),s=s(),V(),s),Z={class:"sot-ob"},ee={class:"wrapper flex"},se={class:"user_card flex auto"},te={class:"interactiv user_card_div auto",id:"checkout"},oe={class:"w-sto kor",id:"kor"},re=B(()=>e("p",{class:"small-big VAG"},"Оформление",-1)),ae={class:"w-sto flex kor_block jus-sp"},_e={style:{width:"50%","padding-top":"20px","padding-left":"2%"}},de=B(()=>e("p",{align:"left",class:"VAG small"},"Товары",-1)),ce={class:"w-sto flex jus-sp"},ie={class:"VAG"},ne={class:"VAG"},le={class:"flex"},ue={class:"img_order_product_div"},pe=["src"],ve={class:"info_order_product_div"},fe={class:"name_order_product"},he={style:{width:"40%"},class:"register_zakaz"};function me(s,o,i,d,u,n){const t=l("checkout",!0),p=l("Submit_order"),A=l("ProductListInfo");return _(),c("div",Z,[e("div",ee,[e("div",se,[e("div",te,[e("div",oe,[re,e("div",ae,[e("div",_e,[v(t,{ref:"checkout_form"},null,512),de,(_(!0),c(f,null,h(s.$store.getUser.basket,(r,C)=>(_(),c("div",{key:r.id,class:"product_order_info"},[e("div",ce,[e("p",ie,a(C+1),1),$(),e("p",ne,a(r.productItem.product.price*r.count)+" "+a(r.productItem.product.price_currency),1)]),e("div",le,[e("div",ue,[e("img",{class:"img_order_product",src:s.$api_root+r.productItem.product.image,alt:""},null,8,pe)]),e("div",ve,[e("div",fe,a(r.productItem.product.name)+" ["+a(r.productItem.weight.weight)+" гр, "+a(r.productItem.type_packaging.name)+"]",1),e("p",null,a(r.productItem.product.price)+" "+a(r.productItem.product.price_currency),1),e("p",null,a(r.count)+" шт",1)])])]))),128))]),e("div",he,[v(p,{onForms_validate_met:n.forms_validate_met,items:s.$store.getUser.basket,forms_validate:u.forms_validate},null,8,["onForms_validate_met","items","forms_validate"]),v(A,{items:s.$store.getUser.basket},null,8,["items"])])])])])])])])}const ge=m(Y,[["render",me],["__scopeId","data-v-bf2e6f6c"]]);export{ge as default};
