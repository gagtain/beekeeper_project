import{C as F}from"./CatalogProduct.2f612997.js";import{h as k,i as w,j as v,a as A,o as l,b as i,e as s,F as m,k as y,w as x,t as C,p as b,l as L,m as f,q as I,r as h,f as p,s as O,c as $,v as M,x as E}from"./entry.e4d18448.js";import{L as R}from"./LoadingComp.277b7951.js";import"./FavoriteComp.eaf61b62.js";import"./removeFavorite.559452a9.js";async function z(t){try{var e=await k({url:`${w}api/v0.1/beekeeper_web_api/product?size=${t}`,method:"get",headers:{Authorization:`Bearer ${v("assess").value}`}});return e}catch(a){return a.response}}const q={el:"#filter",name:"FilterCatalog",data(){return{filter_catalog:[],filter_class_name:[],filter_packaging_name:[],cat_list:[]}},props:["catalog_list","category_list","type_packaging"],methods:{addClassFilter(t){var a;t=(a=t==null?void 0:t.srcElement)!=null&&a.children[0]?t.srcElement:t.target.parentNode,this.addClassActive(t);let e=this.filter_class_name.indexOf(t.children[0].innerHTML);e>=0?(this.filter_class_name.splice(e,1),console.log(this.filter_class_name),this.c()):(this.filter_class_name.push(t.children[0].innerHTML),this.c())},c(){let t=this.b(this.a());this.$store.REFACTOR_CATALOG_LIST(t)},a(){let t=this.catalog_list.slice();return this.filter_class_name.forEach(e=>{console.log(e),t=t.filter(a=>a.category.find(_=>_.name==e))}),t},addPackagingFilter(t){var a;t=(a=t==null?void 0:t.srcElement)!=null&&a.children[0]?t.srcElement:t.target.parentNode,this.addClassActive(t);let e=this.filter_packaging_name.indexOf(t.children[0].innerHTML);e>=0?(this.filter_packaging_name.splice(e,1),this.c()):(this.filter_packaging_name.push(t.children[0].innerHTML),this.c())},b(t){return this.filter_packaging_name.forEach(e=>{t=t.filter(a=>a.type_packaging.find(_=>_.name==e))}),t},addClassActive(t){console.log(t),t.classList.contains("active")?t.classList.remove("active"):t.classList.add("active")}},setup(){}},T=t=>(b("data-v-2af60142"),t=t(),L(),t),B={id:"filter"},G=T(()=>s("p",{class:"filter-p small"},"Категория",-1)),P={class:"filter-ul"},U=T(()=>s("p",{class:"filter-p small"},"Тип упаковки",-1)),H={class:"filter-ul"};function V(t,e,a,_,o,r){return l(),i("div",B,[G,s("ul",P,[(l(!0),i(m,null,y(a.category_list,(c,d)=>(l(),i("li",{onClick:e[1]||(e[1]=n=>r.addClassFilter(n)),key:d,class:"filter-li"},[s("p",{onClick:e[0]||(e[0]=x(n=>r.addClassFilter(n),["stop"])),class:"normal-small"},C(c.name),1)]))),128))]),U,s("ul",H,[(l(!0),i(m,null,y(a.type_packaging,(c,d)=>(l(),i("li",{onClick:e[3]||(e[3]=n=>r.addPackagingFilter(n)),key:d,class:"filter-li"},[s("p",{onClick:e[2]||(e[2]=x(n=>r.addPackagingFilter(n),["stop"])),class:"normal-small"},C(c.name),1)]))),128))])])}const j=A(q,[["render",V],["__scopeId","data-v-2af60142"]]);const J={el:"#sorted",name:"SortedCatalog",data(){return{sorted_list:[],sorteredAlf:!1,sorteredMonet:!1,sorteredNew:!1}},props:["catalog_list"],methods:{sorteredAlfFunc(){let t=this.$store.getCatalog_list.sort((e,a)=>e.name.localeCompare(a.name));this.sorteredAlf=!this.sorteredAlf,this.sorteredMonet=!1,this.sorteredNew=!1,this.$store.REFACTOR_CATALOG_LIST(t)},sorteredMoneyFUnc(){let t=this.$store.getCatalog_list.sort((e,a)=>parseFloat(a.price)-parseFloat(e.price));this.sorteredMonet=!this.sorteredMonet,this.sorteredAlf=!1,this.sorteredNew=!1,this.$store.REFACTOR_CATALOG_LIST(t)},sorteredNewFUnc(){let t=this.$store.getCatalog_list.sort((e,a)=>parseFloat(a.id)-parseFloat(e.id));this.sorteredNew=!this.sorteredNew,this.sorteredMonet=!1,this.sorteredAlf=!1,this.$store.REFACTOR_CATALOG_LIST(t)}},setup(){}},D={class:"sorted-product flex jus-sp",id:"sorted"};function K(t,e,a,_,o,r){return l(),i("div",D,[s("p",{onClick:e[0]||(e[0]=c=>r.sorteredAlfFunc()),class:f([o.sorteredAlf?"act_sorted-p":"","sorted-p small"])}," По имени ",2),s("p",{onClick:e[1]||(e[1]=c=>r.sorteredMoneyFUnc()),class:f([o.sorteredMonet?"act_sorted-p":"","sorted-p small"])}," По цене ",2),s("p",{onClick:e[2]||(e[2]=c=>r.sorteredNewFUnc()),class:f([o.sorteredNew?"act_sorted-p":"","sorted-p small"])}," Новое ",2)])}const Q=A(J,[["render",K],["__scopeId","data-v-5ca13951"]]);async function W(){try{var t=await k({url:`${w}api/v0.1/beekeeper_web_api/category`,method:"get",headers:{Authorization:`Bearer ${v("assess").value}`}});return t}catch(e){return e.response}}async function X(){try{var t=await k({url:`${w}api/v0.1/beekeeper_web_api/type_packaging`,method:"get",headers:{Authorization:`Bearer ${v("assess").value}`}});return t}catch(e){return e.response}}const Y={el:"#catalog",name:"CatalogItem",components:{FilterCatalog:j,SortedCatalog:Q,CatalogProduct:F,LoadingComp:R},data(){return{catalog_list:[{id:0,name:"",image:"",price:"",price_currency:"",description:"",category:[{name:""}],type_packaging:{name:""}}],filter_teleport:!1,category_list:[],type_packaging:[],CATALOG_LIST_STATE:this.$store.getCatalog_list,filters:!1,catalog_loads:!1}},async mounted(){this.restartCatalog(),this.filterReg()},methods:{async clear_filter(){await this.$router.replace({query:null}),setInterval(()=>{var t;(t=this.$route.query)!=null&&t.filter||this.$router.go()},100)},async restartCatalog(){var e;this.catalog_loads=!1;let t=null;(e=this.$route.query)!=null&&e.filter?(t=await I(`name=${JSON.parse(this.$route.query.filter).name}&fields=["__all__"]`),this.filters=!0):t=await z(50),this.catalog_list=t.data,this.catalog_list_sorted=this.catalog_list.slice(),this.$store.REFACTOR_CATALOG_LIST(this.catalog_list),this.catalog_loads=!0},async filterReg(){let t=await W();this.category_list=t.data;let e=await X();this.type_packaging=e.data}},setup(){},watch:{"$route.query":async function(){this.restartCatalog()}}},g=t=>(b("data-v-38484ac1"),t=t(),L(),t),Z={id:"catalog"},tt={class:"absolute flex w-sto h_sto",style:{"pointer-events":"none"}},et={id:"dialog",class:"absolute auto",style:{"pointer-events":"auto"}},st=g(()=>s("button",{class:"btn w-sto btn-green",onclick:"window.dialog.close();"},"Показать",-1)),at=g(()=>s("button",{onclick:"window.dialog.close();","aria-label":"close",class:"x"}," ❌ ",-1)),ot={class:"sot-ob"},lt={class:"wrapper-product w-sto flex"},it={class:"interactiv auto back"},rt={key:0,style:{"margin-left":"5%"},class:"small"},ct={class:"flex w-sto product_div"},nt={class:"block filter_div"},_t={class:"filter-product",id:"filter_desk"},dt={class:"product_osnov relative"},pt={class:"sorted_div flex jus-sp"},gt=g(()=>s("div",{class:"mob_filter relative"},[s("p",{onclick:"window.dialog.showModal();",class:"open_filter_mob"}," Фильтрация ")],-1)),ut={key:0,class:"w-sto product-list flex"},ft={key:2,style:{width:"50%",margin:"auto","margin-top":"10%"}},ht=g(()=>s("div",{style:{"text-align":"center"},class:"flex w-sto"},[s("p",{style:{"font-size":"28px"},class:"VAG auto"},"Товаров с выбранными параметрами нету :(")],-1)),mt={class:"select_size"};function yt(t,e,a,_,o,r){const c=h("FilterCatalog"),d=h("SortedCatalog"),n=F,S=h("LoadingComp"),N=E;return l(),i("div",Z,[s("div",tt,[s("dialog",et,[p(c,{category_list:o.category_list,type_packaging:o.type_packaging,catalog_list:o.catalog_list,onUpdateClassFiler:t.filterClassReg},null,8,["category_list","type_packaging","catalog_list","onUpdateClassFiler"]),st,at])]),s("div",ot,[s("div",lt,[s("div",it,[o.filters?(l(),i("p",rt,C(JSON.parse(this.$route.query.filter).name),1)):O("",!0),s("div",ct,[s("div",nt,[s("div",_t,[p(c,{category_list:o.category_list,type_packaging:o.type_packaging,catalog_list:o.catalog_list},null,8,["category_list","type_packaging","catalog_list"])])]),s("div",dt,[s("div",pt,[p(d,{catalog_list:o.catalog_list},null,8,["catalog_list"]),gt]),t.$store.getCatalog_list.length?(l(),i("div",ut,[(l(!0),i(m,null,y(t.$store.getCatalog_list,u=>(l(),$(n,{key:u.id,pr:u},null,8,["pr"]))),128))])):o.catalog_loads?(l(),i("div",ft,[ht,s("div",mt,[p(N,{to:"/catalog"},{default:M(()=>[s("button",{onClick:e[0]||(e[0]=u=>r.clear_filter()),style:{background:"rgb(255, 188, 65)",cursor:"pointer",width:"100%",border:"medium none","border-radius":"6px","font-size":"26px",padding:"2%","margin-top":"1%"}}," Сбросить настройки ")]),_:1})])])):(l(),$(S,{key:1}))])])])])])])}const xt=A(Y,[["render",yt],["__scopeId","data-v-38484ac1"]]);export{xt as default};
