import{h as T,i as b,j as S,a as k,r as l,o as c,b as u,y as I,c as C,v as y,e as s,t as a,p as f,l as g,F as A,k as B,f as m,s as w}from"./entry.5741de8d.js";import{A as x,F as R}from"./FavoriteComp.5fafa66e.js";async function U(){try{var t=await T({url:`${b}api/v0.1/beekeeper_web_api/order/create`,method:"post",headers:{Authorization:`Bearer ${S("assess").value}`}});return t}catch(e){return e.response}}const F={el:"#reg_zakaz",name:"BasketInfo",data(){return{summ:0,USER_STATE:this.$store.getUser}},created(){},methods:{getCountBasket(){let t=0;return this.USER_STATE.basket.forEach(e=>{t+=parseInt(e.count)}),t},getWeight(){let t=this.USER_STATE.basket.reduce(function(o,r){return o+parseFloat(r.productItem.weight.weight*r.count)},0),e="";return t>=1e3?(t=t/1e3,e=`${t} кг`):e=`${t} гр`,e},getSumm(){return this.USER_STATE.basket.reduce(function(e,o){return e+parseFloat(o.productItem.product.price*o.count)},0)},async submin_order(){(await U()).status==200&&this.$router.push("/orders")}}},h=t=>(f("data-v-5a39c212"),t=t(),g(),t),z={class:"register_zakaz"},O=h(()=>s("div",{class:"fon_btn"},null,-1)),K=h(()=>s("button",{class:"w-sto"},[s("div",{class:"fon_btn"}),I(" Добавить товар")],-1)),L={class:"kor_all_info auto w-sto m-2"},P={class:"m2"},N={class:"m2"},V={class:"m2"},M=h(()=>s("p",{class:"m2"},"скидки:",-1)),j=h(()=>s("ul",null,[s("li",null,"*в разработке*")],-1)),D={id:"is",class:"small"};function G(t,e,o,r,d,i){const n=l("RouterLink");return c(),u("div",z,[d.USER_STATE.basket.length?(c(),u("button",{key:0,class:"w-sto",onClick:e[0]||(e[0]=p=>i.submin_order())},[O,I("Оформить")])):(c(),C(n,{key:1,to:"/catalog"},{default:y(()=>[K]),_:1})),s("div",L,[s("p",P,"Товаров: "+a(i.getCountBasket()),1),s("p",N,"Вес: "+a(i.getWeight()),1),s("p",V," Цена: "+a(d.USER_STATE.basket.reduce(function(p,v){return p+parseFloat(v.productItem.product.price)},0)),1),M,j,s("p",D," Итоговая сумма: "+a(i.getSumm()),1)])])}const W=k(F,[["render",G],["__scopeId","data-v-5a39c212"]]);async function q(t,e){try{var o=await T({url:`${b}api/v0.1/beekeeper_web_api/basket/${t}/update_count`,method:"post",headers:{Authorization:`Bearer ${S("assess").value}`},data:{count:e}});return o}catch(r){return r.response}}const H={el:"#count_button",name:"CountProduct",props:["id"],data(){return{time_prover:null,USER_STATE:this.$store.getUser}},methods:{async re_basketItem(){let t=await q(this.id,this.USER_STATE.basket.filter(e=>e.id==this.id)[0].count);t.status==400?this.$store.REMOVE_BASKET_ITEM(this.id):this.USER_STATE.basket.filter(e=>e.id==this.id)[0]==t.data},re_count(t){t.srcElement.value==""||t.srcElement.value=="0"||(this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id:this.id,count:parseInt(t.srcElement.value)}),this.re_basketItem())},input_onfocus(t){t.srcElement.value==""?t.srcElement.value=this.BASKET_LIST_STATE.filter(e=>e.id==this.id)[0].count:t.srcElement.value=="0"&&(this.BASKET_LIST_STATE.filter(e=>e.id==this.id)[0].count!=1?(this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id:this.id,count:1}),this.re_basketItem()):t.srcElement.value=1)},minus_input(t){let e=t.srcElement.nextElementSibling,o=parseInt(e.value);e.value>1&&(this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id:this.id,count:o-1}),setTimeout(()=>{let r=o-1;r==t.srcElement.nextElementSibling.value?(this.re_basketItem(),console.log(1)):console.log(r,t.srcElement.nextElementSibling.value)},1e3))},plus_input(t){let e=t.srcElement.previousElementSibling,o=parseInt(e.value);this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id:this.id,count:o+1}),setTimeout(()=>{o+1==t.srcElement.previousElementSibling.value&&(this.re_basketItem(),console.log(1))},1e3)},input_keydown(t){t.keyCode==46||t.keyCode==8||t.keyCode==9||t.keyCode==65&&t.ctrlKey===!0||t.keyCode>=35&&t.keyCode<=39||(t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}}},J={class:"input-number",id:"count_button"},Q=["value"];function X(t,e,o,r,d,i){return c(),u("div",J,[s("div",{class:"input-number__minus",onClick:e[0]||(e[0]=n=>i.minus_input(n))},"-"),s("input",{class:"input-number__input",onKeydown:e[1]||(e[1]=n=>i.input_keydown(n)),type:"text",pattern:"^[0-9]+$",onFocusout:e[2]||(e[2]=n=>i.input_onfocus(n)),onInput:e[3]||(e[3]=n=>i.re_count(n)),value:d.USER_STATE.basket.filter(n=>n.id==o.id)[0].count},null,40,Q),s("div",{class:"input-number__plus",onClick:e[4]||(e[4]=n=>i.plus_input(n))},"+ ")])}const Y=k(H,[["render",X]]);const Z={data(){return{USER_STATE:this.$store.getUser}},components:{AddBasket:x,FavoriteComp:R,CountProduct:Y},created(){},methods:{}},E=t=>(f("data-v-c125e0de"),t=t(),g(),t),tt={class:"list_tovar_kor w-sto"},et={class:"tovar_kor_img_div"},st=["src"],ot={class:"info_tovar_kor flex jus-sp"},nt={class:"info_tovar_kor_osnov"},rt={class:"normal-small tovar_kor_name"},it={class:"normal-small info_in_tovar_kor description"},_t={class:"btn_tovar_kor flex"},at={class:"size_tovar_div"},ct={class:"size_tovar_kor"},dt={class:"select_size"},ut=E(()=>s("button",{style:{background:"rgb(76, 175, 80)",cursor:"pointer",width:"100%",height:"32px",border:"none","border-radius":"6px"},onclick:"alert('в разработке')"},"Изменить",-1)),lt=E(()=>s("p",{class:"normal-small kolvo"},"количество",-1)),pt={key:0,style:{width:"50%",margin:"auto","margin-top":"10%"}},mt=E(()=>s("p",{style:{"font-size":"28px"},class:"VAG"},"Список корзины пуст :(",-1)),kt={class:"select_size"},ht=E(()=>s("button",{style:{background:"rgb(76, 175, 80)",cursor:"pointer",width:"100%",border:"medium none","border-radius":"6px","font-size":"26px",padding:"2%","margin-top":"1%"}}," Перейти в каталог ",-1));function Et(t,e,o,r,d,i){const n=l("FavoriteComp"),p=l("AddBasket"),v=l("CountProduct"),$=l("router-link");return c(),u("div",tt,[(c(!0),u(A,null,B(d.USER_STATE.basket,_=>(c(),u("div",{key:_.id,class:"tovar w-sto flex"},[s("div",et,[s("img",{class:"tovar_kor_img",src:t.$api_root+_.productItem.product.image,alt:""},null,8,st)]),s("div",ot,[s("div",nt,[s("p",rt,a(_.productItem.product.name)+" ["+a(_.productItem.weight.weight)+" гр, "+a(_.productItem.type_packaging.name)+"]",1),s("p",it,a(_.productItem.product.price)+" "+a(_.productItem.product.price_currency),1),s("div",_t,[m(n,{ProductItem:_.productItem},null,8,["ProductItem"]),m(p,{ProductItem:_.productItem},null,8,["ProductItem"])])]),s("div",at,[s("div",ct,[s("div",dt,[ut,lt,m(v,{id:_.id},null,8,["id"])])])])])]))),128)),d.USER_STATE.basket.length?w("",!0):(c(),u("div",pt,[mt,s("div",kt,[m($,{to:"/catalog"},{default:y(()=>[ht]),_:1})])]))])}const vt=k(Z,[["render",Et],["__scopeId","data-v-c125e0de"]]);const ft={el:"#kor",name:"UserBasket",components:{BasketList:vt,BasketInfo:W}},gt=t=>(f("data-v-4b1e6b6d"),t=t(),g(),t),Tt={class:"w-sto kor",id:"kor"},bt=gt(()=>s("p",{class:"small-big VAG"},"Корзина",-1)),St={class:"w-sto flex kor_block"};function It(t,e,o,r,d,i){const n=l("BasketList"),p=l("BasketInfo");return c(),u("div",Tt,[bt,s("div",St,[m(n),m(p)])])}const Ct=k(ft,[["render",It],["__scopeId","data-v-4b1e6b6d"]]);export{Ct as U};
