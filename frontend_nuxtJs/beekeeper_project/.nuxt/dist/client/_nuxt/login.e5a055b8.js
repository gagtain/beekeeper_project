import{_ as w}from"./ImageForm.f79326a4.js";import{k as h,l as m,a as y,h as v,b as r,i as t,j as k,s as l,t as x,B as _,C as c,o as d,p as C,m as V,y as b}from"./entry.60760a49.js";async function p(s){try{var e=await h({url:`${m}api/token/`,method:"post",data:s,headers:{"Content-Type":"application/json"},withCredentials:!0});return e}catch(i){return i.response}}async function j(s){try{var e=await h({url:`${m}api/v0.1/user/set_token`,method:"post",data:s,headers:{"Content-Type":"application/json"},withCredentials:!0});return e}catch(i){return i.response}}const I={el:"#login_main",data(){return{username:"",password:"",login_401:!1,message:null,is_code:!1,code:""}},methods:{async login_request(s){var e;if(this.is_code){let i={username:this.username,password:this.password,token:this.code},a=await p(i);this.default_check_status_login(a)}else{let i={username:this.username,password:this.password},a=await p(i);(a==null?void 0:a.status)==400&&((e=a==null?void 0:a.data)==null?void 0:e.error)=="Не указано поле token"?(await j({username:this.username,password:this.password}),this.is_code=!0):this.default_check_status_login(a)}},async default_check_status_login(s){s.status==200?await this.$router.push("/profile"):s.status==401?this.login_401=!0:s==404&&alert("сайт на проверке, подождите 5 минут")}},mounted(){this.message=this.$route.query.message},setup(){v({title:"Пчелиная артель - Вход",meta:[{name:"description",content:"My amazing site."}]})}},u=s=>(C("data-v-18aed2fd"),s=s(),V(),s),N={id:"login_main"},B={class:"sot-ob"},S={class:"wrapper flex"},T={class:"login-page flex"},q={class:"form"},U=u(()=>t("p",{class:"small login-p"},"Войти в аккаунт ",-1)),D={class:"flex h_sto"},M={class:"login-form auto"},z={class:"error_list"},A={key:0},E={key:1},F={key:2},H=u(()=>t("p",null,"Укажите отправленный вам код",-1)),G=u(()=>t("p",{class:"message"},[b(" Not registered? "),t("a",{href:"#"},"Create an account")],-1));function J(s,e,i,a,o,f){const g=w;return d(),r("div",N,[t("div",B,[t("div",S,[t("div",T,[k(g),t("div",q,[U,t("div",D,[t("div",M,[t("div",z,[o.login_401?(d(),r("div",A," Нету учетной записи с введенными данными ")):l("",!0),o.message?(d(),r("div",E,x(o.message),1)):l("",!0)]),o.is_code?l("",!0):_((d(),r("input",{key:0,type:"text",placeholder:"username","onUpdate:modelValue":e[0]||(e[0]=n=>o.username=n)},null,512)),[[c,o.username]]),o.is_code?(d(),r("div",F,[H,_(t("input",{type:"text",placeholder:"code","onUpdate:modelValue":e[2]||(e[2]=n=>o.code=n)},null,512),[[c,o.code]])])):_((d(),r("input",{key:1,type:"password",placeholder:"password","onUpdate:modelValue":e[1]||(e[1]=n=>o.password=n)},null,512)),[[c,o.password]]),t("button",{onClick:e[3]||(e[3]=n=>f.login_request(n))},"login"),G])])])])])])])}const O=y(I,[["render",J],["__scopeId","data-v-18aed2fd"]]);export{O as default};
