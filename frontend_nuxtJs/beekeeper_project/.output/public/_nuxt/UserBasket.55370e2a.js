import{a as h,r as l,o as c,b as u,e as s,t as a,v as T,c as I,s as b,p as v,l as g,h as $,i as y,j as C,F as A,k as B,f as p,q as x}from"./entry.a3afa070.js";import{A as w,F as R}from"./FavoriteComp.a49b014b.js";const U={el:"#reg_zakaz",name:"BasketInfo",data(){return{summ:0,USER_STATE:this.$store.getUser}},created(){},methods:{getCountBasket(){let t=0;return this.USER_STATE.basket.forEach(e=>{t+=parseInt(e.count)}),t},getWeight(){let t=this.USER_STATE.basket.reduce(function(o,_){return o+parseFloat(_.productItem.weight.weight*_.count)},0),e="";return t>=1e3?(t=t/1e3,e=`${t} кг`):e=`${t} гр`,e},getSumm(){return this.USER_STATE.basket.reduce(function(e,o){return e+parseFloat(o.productItem.product.price*o.count)},0)}}},k=t=>(v("data-v-85414ad2"),t=t(),g(),t),F={class:"register_zakaz"},z={class:"kor_all_info auto w-sto"},K=k(()=>s("p",{class:"VAG small zakaz_info_of"},"Информация о корзине",-1)),L={class:"m2"},O={class:"m2"},P={class:"m2"},N=k(()=>s("p",{class:"m2"},"скидки:",-1)),V=k(()=>s("ul",null,[s("li",null,"*в разработке*")],-1)),M={id:"is",class:"small"},G={key:0,class:"w-sto"},j=k(()=>s("div",{class:"fon_btn"},null,-1)),D=k(()=>s("button",{class:"w-sto"},[s("div",{class:"fon_btn"}),T(" Добавить товар")],-1));function W(t,e,o,_,d,i){const n=l("RouterLink");return c(),u("div",F,[s("div",z,[K,s("p",L,"Товаров: "+a(i.getCountBasket()),1),s("p",O,"Вес: "+a(i.getWeight()),1),s("p",P," Цена: "+a(d.USER_STATE.basket.reduce(function(m,f){return m+parseFloat(f.productItem.product.price)},0)),1),N,V,s("p",M," Итоговая сумма: "+a(i.getSumm()),1),d.USER_STATE.basket.length?(c(),u("button",G,[j,T("Оформить")])):(c(),I(n,{key:1,to:"/catalog"},{default:b(()=>[D]),_:1}))])])}const q=h(U,[["render",W],["__scopeId","data-v-85414ad2"]]);async function H(t,e){try{var o=await $({url:`${y}api/v0.1/beekeeper_web_api/basket/${t}/update_count`,method:"post",headers:{Authorization:`Bearer ${C("assess").value}`},data:{count:e}});return o}catch(_){return _.response}}const J={el:"#count_button",name:"CountProduct",props:["id"],data(){return{time_prover:null,USER_STATE:this.$store.getUser}},methods:{async re_basketItem(){let t=await H(this.id,this.USER_STATE.basket.filter(e=>e.id==this.id)[0].count);t.status==400?this.$store.REMOVE_BASKET_ITEM(this.id):this.USER_STATE.basket.filter(e=>e.id==this.id)[0]==t.data},re_count(t){t.srcElement.value==""||t.srcElement.value=="0"||(this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id:this.id,count:parseInt(t.srcElement.value)}),this.re_basketItem())},input_onfocus(t){t.srcElement.value==""?t.srcElement.value=this.BASKET_LIST_STATE.filter(e=>e.id==this.id)[0].count:t.srcElement.value=="0"&&(this.BASKET_LIST_STATE.filter(e=>e.id==this.id)[0].count!=1?(this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id:this.id,count:1}),this.re_basketItem()):t.srcElement.value=1)},minus_input(t){let e=t.srcElement.nextElementSibling,o=parseInt(e.value);e.value>1&&(this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id:this.id,count:o-1}),setTimeout(()=>{let _=o-1;_==t.srcElement.nextElementSibling.value?(this.re_basketItem(),console.log(1)):console.log(_,t.srcElement.nextElementSibling.value)},1e3))},plus_input(t){let e=t.srcElement.previousElementSibling,o=parseInt(e.value);this.$store.REFACTOR_COUNT_BASKET_ITEM({basket_id:this.id,count:o+1}),setTimeout(()=>{o+1==t.srcElement.previousElementSibling.value&&(this.re_basketItem(),console.log(1))},1e3)},input_keydown(t){t.keyCode==46||t.keyCode==8||t.keyCode==9||t.keyCode==65&&t.ctrlKey===!0||t.keyCode>=35&&t.keyCode<=39||(t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}}},Q={class:"input-number",id:"count_button"},X=["value"];function Y(t,e,o,_,d,i){return c(),u("div",Q,[s("div",{class:"input-number__minus",onClick:e[0]||(e[0]=n=>i.minus_input(n))},"-"),s("input",{class:"input-number__input",onKeydown:e[1]||(e[1]=n=>i.input_keydown(n)),type:"text",pattern:"^[0-9]+$",onFocusout:e[2]||(e[2]=n=>i.input_onfocus(n)),onInput:e[3]||(e[3]=n=>i.re_count(n)),value:d.USER_STATE.basket.filter(n=>n.id==o.id)[0].count},null,40,X),s("div",{class:"input-number__plus",onClick:e[4]||(e[4]=n=>i.plus_input(n))},"+ ")])}const Z=h(J,[["render",Y]]);const tt={data(){return{USER_STATE:this.$store.getUser}},components:{AddBasket:w,FavoriteComp:R,CountProduct:Z},created(){},methods:{}},E=t=>(v("data-v-c125e0de"),t=t(),g(),t),et={class:"list_tovar_kor w-sto"},st={class:"tovar_kor_img_div"},ot=["src"],nt={class:"info_tovar_kor flex jus-sp"},_t={class:"info_tovar_kor_osnov"},it={class:"normal-small tovar_kor_name"},rt={class:"normal-small info_in_tovar_kor description"},at={class:"btn_tovar_kor flex"},ct={class:"size_tovar_div"},dt={class:"size_tovar_kor"},ut={class:"select_size"},lt=E(()=>s("button",{style:{background:"rgb(76, 175, 80)",cursor:"pointer",width:"100%",height:"32px",border:"none","border-radius":"6px"},onclick:"alert('в разработке')"},"Изменить",-1)),pt=E(()=>s("p",{class:"normal-small kolvo"},"количество",-1)),mt={key:0,style:{width:"50%",margin:"auto","margin-top":"10%"}},kt=E(()=>s("p",{style:{"font-size":"28px"},class:"VAG"},"Список корзины пуст :(",-1)),ht={class:"select_size"},Et=E(()=>s("button",{style:{background:"rgb(76, 175, 80)",cursor:"pointer",width:"100%",border:"medium none","border-radius":"6px","font-size":"26px",padding:"2%","margin-top":"1%"}}," Перейти в каталог ",-1));function ft(t,e,o,_,d,i){const n=l("FavoriteComp"),m=l("AddBasket"),f=l("CountProduct"),S=l("router-link");return c(),u("div",et,[(c(!0),u(A,null,B(d.USER_STATE.basket,r=>(c(),u("div",{key:r.id,class:"tovar w-sto flex"},[s("div",st,[s("img",{class:"tovar_kor_img",src:t.$api_root+r.productItem.product.image,alt:""},null,8,ot)]),s("div",nt,[s("div",_t,[s("p",it,a(r.productItem.product.name)+" ["+a(r.productItem.weight.weight)+" гр, "+a(r.productItem.type_packaging.name)+"]",1),s("p",rt,a(r.productItem.product.price)+" "+a(r.productItem.product.price_currency),1),s("div",at,[p(n,{ProductItem:r.productItem},null,8,["ProductItem"]),p(m,{ProductItem:r.productItem},null,8,["ProductItem"])])]),s("div",ct,[s("div",dt,[s("div",ut,[lt,pt,p(f,{id:r.id},null,8,["id"])])])])])]))),128)),d.USER_STATE.basket.length?x("",!0):(c(),u("div",mt,[kt,s("div",ht,[p(S,{to:"/catalog"},{default:b(()=>[Et]),_:1})])]))])}const vt=h(tt,[["render",ft],["__scopeId","data-v-c125e0de"]]);const gt={el:"#kor",name:"UserBasket",components:{BasketList:vt,BasketInfo:q}},Tt=t=>(v("data-v-4b1e6b6d"),t=t(),g(),t),bt={class:"w-sto kor",id:"kor"},St=Tt(()=>s("p",{class:"small-big VAG"},"Корзина",-1)),It={class:"w-sto flex kor_block"};function $t(t,e,o,_,d,i){const n=l("BasketList"),m=l("BasketInfo");return c(),u("div",bt,[St,s("div",It,[p(n),p(m)])])}const At=h(gt,[["render",$t],["__scopeId","data-v-4b1e6b6d"]]);export{At as U};
